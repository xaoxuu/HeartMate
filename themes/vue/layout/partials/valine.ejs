<% if (config.valine){ %>
  <% if (config.valine.enable && config.valine.appId && config.valine.appKey && (page.comments != false)){ %>
    <% if (page.lang && page.lang == "en"){ %>
      <h2 id="Comments"><a href="#Comments" class="headerlink" title="Comments"><i class="fa fa-comments" aria-hidden="true"></i>Comments</a></h2>
      <p>In order to distinguish and receive reply reminders, please fill in the <b>nickname</b> and <b>E-Mail</b> when you leave a message. </p>
    <% } else { %>
      <h2 id="留言"><a href="#留言" class="headerlink" title="留言"><i class="fa fa-comments" aria-hidden="true"></i>留言</a></h2>
      <p><b>文明评论，请勿灌水</b>。为了便于区分和接收回复提醒，请您在留言时填写一下<b>昵称</b>和<b>邮箱</b>。</p>
    <% } %>
    <% if (page.comments_desc){ %>
        <p><%- page.comments_desc %></p>
    <% } %>
    <section id="comments">
      <div id="valine_container" class="valine_thread">
        <i class="fa fa-spinner fa-spin fa-fw"></i>
      </div>
    </section>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <script>
      var GUEST_INFO = ['nick','mail','link'];
      var guest_info = '<%= config.valine.guest_info %>'.split(',').filter(function(item){
        return GUEST_INFO.indexOf(item) > -1
      });
      var notify = '<%= config.valine.notify %>' == true;
      var verify = '<%= config.valine.verify %>' == true;
      var valine = new Valine();
      valine.init({
        el: '#valine_container',
        notify: notify,
        verify: verify,
        guest_info: guest_info,
        appId: "<%= config.valine.appId %>",
        appKey: "<%= config.valine.appKey %>",
        <% if (page.lang && page.lang == "en"){ %>
          placeholder: "Leave your messages here ~",
        <% } else { %>
          placeholder: "<%= config.valine.placeholder %>",
        <% } %>
        pageSize:'<%= config.valine.pageSize %>',
        avatar:'<%= config.valine.avatar %>',
        <% if (page.lang && page.lang == "en"){ %>
          lang:'en'
        <% } else { %>
          lang:'<%= config.valine.lang %>'
        <% } %>
      })
    </script>
  <% } %>
<% } %>
